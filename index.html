<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PSV Calibration Reports</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>

<div id="dashboard" class="a4-container">
  <h2 class="center">ðŸ“‹ PSV Calibration Reports</h2>
  <button id="addNewBtn">âž• Add New Report</button>
  
  <label class="bulk-label">
    ðŸ“¤ Bulk Upload (Excel):
    <input type="file" id="excelUploadInput" accept=".xlsx,.xls">
  </label>
  
  <button id="downloadTemplateBtn" style="background:#17a2b8;">ðŸ“¥ Download Template</button>

  <table class="report-table">
    <thead>
      <tr>
        <th>Tag No</th>
        <th>Date</th>
        <th>Unit</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="reportList"></tbody>
  </table>
</div>

<div id="formPage" class="a4-container hidden">
  <h3 class="center">NUMALIGARH REFINERY LIMITED</h3>
  <p class="center small">NRL Complex: Numaligarh, Golaghat: Assam</p>
  <h2 class="center underline">SAFETY VALVE CALIBRATION REPORT</h2>

  <div class="header-line">
    <div>Book No.: <input type="text" id="bookNo"></div>
    <div>Sl. No.: <input type="text" id="slNo"></div>
  </div>

  <table class="details-table">
    <tr><td>Date: <input type="date" id="date"></td><td>Time: <input type="time" id="time"></td><td>Unit: <input type="text" id="unit"></td></tr>
    <tr><td colspan="2">Tag No: <input type="text" id="tagNo"></td><td>Type: 
      <select id="type"><option>Conventional</option><option>Balanced Bellow</option><option>Open Bonnet</option></select></td></tr>
    <tr><td colspan="2">Manufacturer: <input type="text" id="manufacturer"></td><td>Service: <input type="text" id="service"></td></tr>
    <tr><td>Work Order No: <input type="text" id="workOrder"></td><td colspan="2">Date: <input type="date" id="woDate"></td></tr>
    <tr><td colspan="3">Changes in Set Pressure (if any): <input type="text" id="changeSet" style="width:80%"></td></tr>
    <tr><td colspan="3">Authorization Ref No & Date: <input type="text" id="authRef" style="width:80%"></td></tr>
    <tr><td colspan="3">Cold Differential Test Pressure (Kg/CmÂ²g): <input type="text" id="coldDiff"></td></tr>
    <tr><td>Back Pressure (Kg/CmÂ²g): <input type="text" id="backPressure"></td><td colspan="2">Set Pressure (Kg/CmÂ²g): <input type="text" id="setPressure"></td></tr>
    <tr><td>Orifice size: <input type="text" id="orifice"></td><td>Testing Medium: <input type="text" id="testingMedium"></td><td></td></tr>
    <tr><td colspan="3">Reasons (for which calibration is required): <input type="text" id="reason" style="width:80%"></td></tr>
    <tr><td colspan="3">Details of Repairs & Replacements: <input type="text" id="repairs" style="width:80%"></td></tr>
  </table>

  <h3 class="center">REPORT</h3>
  <table class="report-table">
    <thead>
      <tr>
        <th>As Received Relieving Pressure (Kg/cmÂ²)</th>
        <th>Set at Kg/cmÂ²(g)</th>
        <th>Holding Time (Min)</th>
        <th>Bubbles per min (Max Permissible)</th>
        <th>Bubbles per min (Observed)</th>
        <th>Status</th>
        <th>Remarks</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td><input type="text" id="asReceived"></td>
        <td><input type="text" id="setAt"></td>
        <td><input type="text" id="holdingTime"></td>
        <td><input type="text" id="bubbleMax"></td>
        <td><input type="text" id="bubbleObs"></td>
        <td><select id="status"><option>Accepted</option><option>Rejected</option></select></td>
        <td><input type="text" id="remarks"></td>
      </tr>
    </tbody>
  </table>

  <p>Whether sealed after calibration: <select id="sealed"><option>Yes</option><option>No</option></select></p>

  <table class="footer-table">
    <tr><td>Witnessed by: <input type="text" id="witness"></td><td>Next Due Date: <input type="date" id="nextDue"></td></tr>
    <tr><td>Signature: <input type="text" id="signature"></td><td></td></tr>
    <tr><td>Name: <input type="text" id="name"></td><td>Date: <input type="date" id="signDate"></td></tr>
  </table>

  <div class="buttons">
    <button id="saveBtn">ðŸ’¾ Save Report</button>
    <button onclick="window.print()">ðŸ–¨ Print / PDF</button>
    <button id="backBtn">â¬… Back to Dashboard</button>
  </div>
</div>

<script src="script.js"></script>
</body>
</html>
